
<div id="outer-video-box" class="video-container" style="margin-left: 200px;">
  <div id="title-box"><h3 style="margin-top: 20px; color:white;"><%= @video.title %></h3></div>
  <div id="watch-again"></div>
  <div id="new-video-box"></div>
  <div id="timer-box"></div>
  <div id="settings">
    <p style="margin-top: 15px; margin-left: 15px; font-size: 15px;">
      <% if current_user %>
        You've watched <span id="video-play-counter"><%= @current_user_play_count %></span> times.
        <i class="icon icon-star-empty icon-2x" id="star" style="position: absolute; top: 10px; right: 10px;"> </i>
      <% else %>
        <%= link_to "Sign in", "/sign_in" %> to track your progress & favorite videos.
      <% end %>
    </p>
    <br>
    <div style="margin-top: 45px; margin-left: 15px; margin-right: 15px; font-size: 14px;">
      <div id='new-tag-area'></div>
      <div id='tag-area'>
        <% if @tags.present? %>
          <div id="tags-list" style="float: left; margin-bottom: 20px;">
            <span id='language-tags' class='tag-category'>
              <% if @lang_tags.present? %>
                <span class="tiny">Language<% if @lang_tags.length > 1 %>s<% end %>:</span> &nbsp;
                <% @lang_tags.each do |t| %>
                  <%= link_to "#{t.name}", tag_url(t) %><% unless t == @last_lang_tag %>, <% end %>
                <% end %>
              <% end %>
            </span>
            <span id='artist-tags' class='tag-category'>
              <% if @artist_tags.present? %>
                <span class="tiny">Artist<% if @artist_tags.length > 1 %>s<% end %>:</span> &nbsp;
                <% @artist_tags.each do |t| %>
                  <%= link_to "#{t.name}", tag_url(t) %><% unless t == @last_artist_tag %>, <% end %>
                <% end %>
              <% end %>
            </span>
            <span id='difficulty-tags' class='tag-category right'>
              <% if @difficulty_tags.present? %>
                <span class="tiny">Difficulty:</span> &nbsp;
                <% @difficulty_tags.each do |t| %>
                  <%= link_to "#{t.name}", tag_url(t) %><% unless t == @last_difficulty_tag %>, <% end %>
                <% end %>
              <% end %>
            </span>
            <span id='style-tags' class='tag-category right'>
              <% if @style_tags.present? %>
                <span class="tiny">Style<% if @style_tags.length > 1 %>s<% end %>:</span> &nbsp;
                <% @style_tags.each do |t| %>
                  <%= link_to "#{t.name}", tag_url(t) %><% unless t == @last_style_tag %>, <% end %>
                <% end %>
              <% end %>
            </span>
          </div>
        <% else %>
        <span style="margin-left: 10px;">
          No tags yet!
        </span>
        <br><br>
        <% end %>
      </div>
      <div id='add-tag-action-prompt' style="margin-left: 10px;">
        <span id="add-tag" class="link-style">Add a tag</span> that describes this video.
      </div>
      <br>
    </div>
  </div>
</div>

<div id="social-content-area" class="content-area"> 
    <% if controller_name == 'videos' %>
      <div id="big-tab" class="tab"> <h3 style="color: white;"> &nbsp; Notes & quizzes &nbsp;</h3> </div>
      <div id="add-new-note" class="tab"> Add your own </div>
    <% elsif controller_name == 'interpretations' %>
      <div id="big-tab" class="tab" style="border-bottom: none !important;"> <h3 style="color: white;"> &nbsp; <%= @user.username %>'s notes & quizzes &nbsp;</h3> </div>
    <% end %>
    <br><br><br>
    <div class="small-tab" style="text-align:justify;"> &nbsp; &nbsp; 
      <% unless @vocabulary.blank? && @multiple_choice.blank? && @translation.blank? %>
        <span id="all" class="active note-category">All</span> &nbsp;
      <% else %>
        <span id="all" class="inactive note-category">All</span> &nbsp;
      <% end %>
      <span id="vocabulary" class="note-category <% if @vocabulary.present? %>active<% else %>inactive<% end %>">
        Vocabulary
      </span> &nbsp;
      <span id="multiple-choice" class="note-category <% if @multiple_choice.present? %>active<% else %>inactive<% end %>">
        Multiple-Choice
      </span> &nbsp; 
      <span id="discussion-question" class="note-category <% if @discussion_questions.present? %>active<% else %>inactive<% end %>">
        Discussion
      </span> &nbsp; 
      <span id="translations" class="note-category <% if @translation.present? %>active<% else %>inactive<% end %>">
        Translation
      </span> &nbsp;
      <span id="links" class="note-category <% if @links.present? %>active<% else %>inactive<% end %>">
        Links
      </span> &nbsp;
      <span id="tweets" class="note-category <% if @tweets.present? %>active<% else %>inactive<% end %>">
        Tweets
      </span> &nbsp;
    </div>

    <div id="community-notes">
      <div id="editing"></div>
      <div id="notes-container">
        <% if @vocabulary.blank? && @multiple_choice.blank? && @translation.blank? %>
          <h3 style="text-align: center;"> None yet.</h3>
          <br><br>
        <% end %>
        <% if @vocabulary.present? %>
          <div class="note-area vocabulary-area">
            <% @vocabulary_contributors.each do |c| %>
              <% c_words = Word.where(:user_id => c.id, :video_id => @video.id) %>
                <% unless current_user %>
                  <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added vocabulary definitions: </p>
                <% else %>
                  <% if current_user.id == c.id %>
                    <p style="font-size: 16px;">You added vocabulary definitions: </p>
                  <% else %>
                    <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added vocabulary definitions: </p>
                  <% end %>
                <% end %>
              <% if current_user %><% if current_user.id == c.id %><div id='current-user-definitions'><% end %><% end %>
                <% c_words.each do |w| %>
                  <% d = Definition.where(:word_id => w.id).first %>
                  <li><%= link_to "#{w.text + " = " + d.text}", definition_url(d) %></li>
                <% end %>
              <% if current_user %><% if current_user.id == c.id %></div><% end %><% end %>
            <% end %>
          </div>
        <% end %>
        <% if @challenge_contributors.present? %>
          <div class="note-area multiple-choice-area">
            <% @challenge_contributors.each do |c| %>
              <% @challenges = Challenge.where(:user_id => c.id).all %>
                <% unless current_user %>
                  <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a question: </p>
                <% else %>
                  <% if current_user.id == c.id %>
                    <p style="font-size: 16px;">You added a question: </p>
                  <% else %>
                    <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a question: </p>
                  <% end %>
                <% end %>
              <% if current_user %><% if current_user.id == c.id %><div id='current-user-challenges'><% end %><% end %>
                <% @challenges.each do |challenge| %>
                  <p> <%= challenge.question_text %> </p>
                  <% options = Option.where(:challenge_id => challenge.id).all %>
                  <% options.each do |o| %>
                    <p style="margin-left: 20px;"> <input type='checkbox' id="option-<%= o.id %>" class="option-challenge-<%= challenge.id %>"> <%= o.answer_text %> </p>
                  <% end %>
                <div id='submit-challenge-<%= challenge.id %>' class='submit-challenge-answer btn btn-primary btn-small rounded' style="margin-left: 20px;"> Add your answer </div>
                <br><br>
              <% end %>
              <% if current_user %><% if current_user.id == c.id %></div><% end %><% end %>
            <% end %>
          </div>
        <% end %>
        <% if @discussion_questions.present? %>
          <div class="note-area discussion-question-area">
            <% @question_contributors.each do |c| %>
              <% @questions = DiscussionQuestion.where(:user_id => c.id, :video_id => @video.id).all %>
                <% unless current_user %>
                  <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a question: </p>
                <% else %>
                  <% if current_user.id == c.id %>
                    <p style="font-size: 16px;">You added a question: </p>
                  <% else %>
                    <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a question: </p>
                  <% end %>
                <% end %>
              <% if current_user %><% if current_user.id == c.id %><div id='current-user-discussion-questions'><% end %><% end %>
                <% @questions.each do |question| %>
                  <p> <%= question.question_text %> </p>
                <% end %>
              <% if current_user %><% if current_user.id == c.id %></div><% end %><% end %>
              <div id='submit-answer-<%= c.id %>' class='btn btn-primary btn-small rounded' style="margin-left: 20px;"> Add your answer </div>
              <br><br>
            <% end %>
          </div>
        <% end %>
        <% if @translation.present? %>
          <div class="note-area translation-area">
            <% @translation_contributors.each do |c| %>
              <p style="font-size: 16px;">
                <%= link_to "#{c.username}", user_url(c) %> added a translation:
              </p>
              <%= render "videos/translation", :lines => @lines %>
            <% end %>
          </div>
        <% end %>
        <% if @links.present? %>
          <div class="note-area links-area">
            <% @link_contributors.each do |c| %>
              <% @links = Link.where(:user_id => c.id, :video_id => @video.id).all %>
                <% unless current_user %>
                  <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a link: </p>
                <% else %>
                  <% if current_user.id == c.id %>
                    <p style="font-size: 16px;">You added a link: </p>
                  <% else %>
                    <p style="font-size: 16px;"><%= link_to "#{c.username}", user_url(c) %> added a link: </p>
                  <% end %>
                <% end %>
                <% if current_user %><% if current_user.id == c.id %><div id='current-user-links'><% end %><% end %>
                  <% @links.each do |link| %>
                    <%= image_tag "http://g.etfv.co/#{link.url}", :size => '25x25' %>
                    <strong><%= link_to "#{link.url.split('/')[2]}", link.url %></strong>
                    <p><%= link.excerpt %></p>
                  <% end %>
                <% if current_user %><% if current_user.id == c.id %></div><% end %><% end %>
              <% end %>
            </div>
          <% end %>
        <% if @tweets.present? %>
          <div class="note-area tweets-area">
            <% @tweet_contributors.each do |c| %>
              <% @tweets = Tweet.where(:user_id => c.id, :video_id => @video.id).all %>
                <% unless current_user %>
                  <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a Tweet: </p>
                <% else %>
                  <% if current_user.id == c.id %>
                    <p style="font-size: 16px;"> You added a Tweet: </p>
                  <% else %>
                    <p style="font-size: 16px;"> <%= link_to "#{c.username}", user_url(c) %> added a Tweet: </p>
                  <% end %>
                <% end %>
                <% if current_user %><% if current_user.id == c.id %><div id='current-user-tweets'><% end %><% end %>
                  <% @tweets.each do |tweet| %>
                    <blockquote class="twitter-tweet"><a href="https://twitter.com/<%= tweet.tweeter %>/statuses/<%= tweet.twitter_id %>"></a></blockquote>
                  <% end %>
                <% if current_user %><% if current_user.id == c.id %></div><% end %><% end %>
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="data" class="quiet"
 data-youtube-id=<%= @video.youtube_id %>
 data-title=<%= @video.title %>
 data-video-id=<%= @video.id %>
</div>