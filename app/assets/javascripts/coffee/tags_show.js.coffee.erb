$ -> 

  tag = document.createElement("script")
  tag.src = "https://www.youtube.com/iframe_api"
  firstScriptTag = document.getElementsByTagName("script")[0]
  firstScriptTag.parentNode.insertBefore tag, firstScriptTag
  
  youtube_id = $('#data').attr('data-youtube-id')

  window.onYouTubeIframeAPIReady = ->
    player = new YT.Player("new-video-box", {
      height: "225"
      width: "300"
      videoId: youtube_id
      playerVars: 
        {
        wmode: "opaque"
        }
      events:
        onReady: onPlayerReady
        onStateChange: onPlayerStateChange })

    onPlayerReady = (event) ->
      event.target.playVideo()
    
    onPlayerStateChange = (event) ->
      console.log player.getState()

  $('.vote').click ->
    $(this).addClass('blue')
    if $(this).attr('id') == 'upvote'
      old_upvotes = parseInt($('#video-upvotes-status').text())
      new_upvotes = old_upvotes + 1
      $('#video-upvotes-status').text(new_upvotes)
      $('#video-upvotes-status').addClass('blue')      
    if $(this).attr('id') == 'downvote'
      old_upvotes = parseInt($('#video-downvotes-status').text())
      new_upvotes = old_upvotes - 1
      $('#video-downvotes-status').text(new_upvotes)
      $('#video-downvotes-status').addClass('blue')      
